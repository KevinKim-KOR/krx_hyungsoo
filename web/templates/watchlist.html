<!-- web/templates/watchlist.html -->
<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Watchlist</title>
  <style>
    body{font-family:system-ui,Segoe UI,Arial;max-width:960px;margin:24px auto;padding:0 12px}
    .muted{color:#888}
    .row{display:flex;gap:12px;align-items:center;margin:8px 0}
    textarea{width:100%;height:320px;font-family:ui-monospace,Consolas,monospace}
    .btn{background:#111;color:#fff;border:0;border-radius:8px;padding:8px 12px;cursor:pointer}
  </style>
</head>
<body>
  <h2>Watchlist 편집</h2>
  <div class="muted">파일: {{ path }} · 현재 {{ count }}개</div>
  <form id="wl-form" class="row" onsubmit="return false;">
    <textarea name="text" id="wl-text">{{ text }}</textarea>
  </form>
  <div class="row">
    <button class="btn" id="btn-save">저장</button>
    <span id="msg" class="muted"></span>
  </div>

  <script>
    const btn = document.getElementById('btn-save');
    const msg = document.getElementById('msg');
    btn.addEventListener('click', async ()=>{
      msg.textContent = '저장 중…';
      const fd = new FormData();
      fd.append('text', document.getElementById('wl-text').value || '');
      try{
        const r = await fetch('/api/watchlist/save', {method:'POST', body:fd});
        const j = await r.json();
        msg.textContent = j.ok ? `저장 완료 (${j.count}개)` : '저장 실패';
      }catch(e){ msg.textContent = '네트워크 오류'; }
      setTimeout(()=> msg.textContent='', 3000);
    });
  </script>
</body>
</html>
