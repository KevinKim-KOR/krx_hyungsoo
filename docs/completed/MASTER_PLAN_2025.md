# 마스터 플랜 2025

**최종 업데이트**: 2025-11-10  
**현재 상태**: Phase 2 완료 + 포트폴리오 UI 완성 + 리포트 통합 진행 중

---

## 📊 현재 상태 (2025-11-09)

### ✅ 완료된 Phase

#### **Phase 1: 기반 시스템 구축** (2025-10-24 완료)
- ✅ 데이터 수집 파이프라인 (PyKRX → FDR → Stooq → YahooFinance)
- ✅ SQLite DB + Parquet 캐시
- ✅ NAS/PC 환경 분리
- ✅ 의존성 90% 감소

#### **Phase 2: 백테스트 전략 개발** (2025-11-08 완료)
- ✅ **Week 1**: KRX MAPS 엔진 통합 (CAGR 39%, Sharpe 1.71)
- ✅ **Week 2**: 방어 시스템 구현 (MDD -23% → -17%)
- ✅ **Week 3**: 하이브리드 전략 (CAGR 27%, Sharpe 1.51) ⭐
- ✅ **Week 4**: 자동화 시스템 (텔레그램 알림, Streamlit 대시보드)

**최종 성과** (2022-01-01 ~ 2025-11-08):
- CAGR: **27.05%** (목표 30%의 90%)
- Sharpe Ratio: **1.51** (목표 1.5 달성!) ✅
- Max Drawdown: **-19.92%**
- 총 수익률: **96.80%**
- 거래 수: **1,406회**

#### **NAS PUSH 시스템** (2025-11-08 완료)
- ✅ 일일 리포트 (평일 16:00)
- ✅ 주간 리포트 (토요일 10:00)
- ✅ 레짐 변경 알림 (실시간)
- ✅ 텔레그램 메시지 개선 (종목명, MAPS 강도, 상세 전략)
- ✅ NAS Cron 설정 완료

---

## 🚀 진행 중인 Phase

### **Phase 2.5: 포트폴리오 통합** (2025-11-10 ~ 2025-11-23)

**목표**: 실제 보유 종목 기반 자동화 시스템 구축

#### **Week 1: UI 개선 + 리포트 통합** (11/10 ~ 11/16)

**완료** (2025-11-10):
- ✅ 포트폴리오 관리 UI 구현
  - ✅ 종목 추가/수정/삭제
  - ✅ 추가 매수 (평균 단가 자동 계산)
  - ✅ 증권사 정보 관리
  - ✅ 소수점 수량 지원 (토스백크 매일모으기)
- ✅ 네이버 금융 크롤링
  - ✅ 실시간 현재가 조회
  - ✅ 자동 종목명 조회
  - ✅ 모든 국내 상장 종목 지원
- ✅ UI 개선
  - ✅ 수익/손실 색상 (빨강/파랑)
  - ✅ 증권사 → 코드 순 정렬
  - ✅ 금액 포맷 개선
  - ✅ 중복 종목 체크

**진행 중** (11/11 ~ 11/13):
- 🔄 포트폴리오 로더 구현
- 🔄 일일 리포트 개선 (실제 보유 종목 연동)
- 🔄 주간 리포트 개선 (실제 보유 종목 연동)

**다음 작업** (11/14 ~ 11/16):
1. **목요일 (11/14)**: 테스트 및 디버깅
   - [ ] 일일 리포트 테스트
   - [ ] 주간 리포트 테스트
   - [ ] 텔레그램 알림 테스트

2. **금요일 (11/15)**: NAS 배포
   - [ ] NAS에 코드 배포
   - [ ] Cron 설정
   - [ ] 텔레그램 봇 설정

3. **토요일 (11/16)**: 첫 자동 리포트
   - [ ] 주간 리포트 자동 실행 확인
   - [ ] 리포트 내용 검토
   - [ ] 개선 사항 도출

#### **Week 2: 백테스트 통합** (11/17 ~ 11/23)

1. **일~월 (11/17~18)**: 보유 종목 백테스트
   - [ ] 실제 보유 종목 기반 백테스트
   - [ ] 파라미터 최적화 (Optuna 100 trials)
   - [ ] 실전 vs 백테스트 비교

2. **화~목 (11/19~21)**: 주간 백테스트 자동화
   - [ ] 주간 백테스트 스크립트 구현
   - [ ] 텔레그램 리포트 통합
   - [ ] NAS 배포

3. **금~토 (11/22~23)**: 2주 총 정리
   - [ ] 첫 주간 백테스트 실행
   - [ ] 성과 측정 및 분석
   - [ ] Phase 3 계획 수립

---

## 📋 향후 Phase 계획

### **Phase 3: 고급 기능 추가** (2025-12월 ~ 2026-01월)

**예상 기간**: 2개월  
**예상 소요 시간**: 20~30시간

#### 3.1 장중 실시간 알림
- 5분마다 레짐 체크
- 급등/급락 즉시 알림
- 손절 라인 도달 알림

#### 3.2 머신러닝 모델 통합
- LSTM 기반 가격 예측
- 레짐 예측 모델
- 리스크 예측 모델

#### 3.3 포트폴리오 최적화
- 켈리 기준 활용
- 리스크 패리티
- 동적 자산 배분

#### 3.4 백테스트 고도화
- 슬리피지 반영
- 거래 비용 정확한 계산
- 실제 체결가 시뮬레이션

---

### **Phase 4: 자동 매매 시스템** (2026-02월 ~ 2026-03월)

**예상 기간**: 2개월  
**예상 소요 시간**: 30~40시간

#### 4.1 증권사 API 연동
- 한국투자증권 API
- 키움증권 API
- 실시간 시세 조회

#### 4.2 자동 주문 시스템
- 매수/매도 자동 실행
- 주문 체결 확인
- 포지션 관리

#### 4.3 실시간 모니터링
- 포트폴리오 실시간 추적
- 수익률 실시간 계산
- 리스크 지표 모니터링

#### 4.4 비상 정지 시스템
- 급락 시 자동 매도
- 시스템 오류 감지
- 수동 개입 인터페이스

---

### **Phase 5: Oracle Cloud 배포** (2026-04월 ~ 2026-05월)

**예상 기간**: 1.5개월  
**예상 소요 시간**: 12~16시간

#### 5.1 클라우드 환경 구축
- Oracle Cloud 무료 티어 활용
- VM 인스턴스 설정
- 네트워크 보안 설정

#### 5.2 Docker 컨테이너화
- Dockerfile 작성
- Docker Compose 설정
- 이미지 최적화

#### 5.3 CI/CD 파이프라인
- GitHub Actions 설정
- 자동 배포 스크립트
- 테스트 자동화

#### 5.4 모니터링 대시보드
- Grafana 설정
- Prometheus 메트릭 수집
- 알림 설정

---

### **Phase 6: 고급 대시보드** (2026-06월 ~ 2026-07월)

**예상 기간**: 1.5개월  
**예상 소요 시간**: 16~20시간

#### 6.1 백테스트 실행 UI
- 파라미터 입력 폼
- 실행 버튼
- 진행 상황 표시

#### 6.2 전략 설정 UI
- 레짐 파라미터 조정
- 방어 시스템 설정
- 포지션 비율 설정

#### 6.3 성과 분석 대시보드
- 수익률 차트
- 레짐 타임라인
- 거래 내역

#### 6.4 리스크 분석 도구
- MDD 분석
- 변동성 분석
- 상관관계 분석

---

## 🎯 우선순위 및 일정

### **즉시 (이번 주, 11/9 ~ 11/15)**
1. ✅ 하이브리드 실행 시스템 구축
2. 🔄 파라미터 최적화 실행
3. 🔄 실시간 신호 관찰 시작
4. 📋 주간 비교 리포트 생성

### **단기 (2주, 11/16 ~ 11/22)**
5. 📋 1주일 데이터 분석
6. 📋 소액 실전 테스트
7. 📋 성과 측정 및 개선

### **중기 (1개월, 11/23 ~ 12/22)**
8. 📋 실전 투자 확대
9. 📋 파라미터 지속 최적화
10. 📋 Phase 3 준비

### **장기 (3~6개월, 2026-01 ~ 2026-07)**
11. 📋 Phase 3: 고급 기능 추가
12. 📋 Phase 4: 자동 매매 시스템
13. 📋 Phase 5: Oracle Cloud 배포
14. 📋 Phase 6: 고급 대시보드

---

## 📊 성과 목표

### **Phase 2.5 목표** (2주 후, 11/22)
- 신호 정확도: **60% 이상**
- 소액 실전 수익률: **플러스 유지**
- 레짐 감지 정확도: **80% 이상**
- 일일 모니터링 시간: **10분 이내**

### **Phase 3 목표** (2개월 후, 2026-01)
- CAGR: **30% 이상**
- Sharpe Ratio: **1.6 이상**
- MDD: **-15% 이내**
- 자동화율: **90% 이상**

### **Phase 4 목표** (4개월 후, 2026-03)
- 완전 자동 매매 구현
- 수동 개입: **주 1회 이내**
- 시스템 안정성: **99% 이상**

### **Phase 5 목표** (6개월 후, 2026-05)
- 클라우드 배포 완료
- 24/7 운영
- 모니터링 대시보드 구축

### **Phase 6 목표** (8개월 후, 2026-07)
- 전문가급 분석 도구
- 파라미터 실시간 조정
- 성과 분석 자동화

---

## 📁 프로젝트 구조

```
krx_alertor_modular/
├── core/                      # 공통 모듈
│   ├── db.py
│   ├── fetchers.py
│   └── providers/
│
├── extensions/                # 확장 기능
│   ├── automation/            # 자동화 (Phase 2 완료)
│   │   ├── telegram_notifier.py
│   │   ├── daily_report.py
│   │   ├── weekly_report.py
│   │   └── signal_generator.py
│   ├── monitoring/            # 레짐 감지
│   └── backtest/              # 백테스트 엔진
│
├── scripts/
│   ├── automation/            # NAS 자동화 스크립트
│   │   ├── daily_alert.sh
│   │   └── weekly_alert.sh
│   ├── monitoring/            # 실시간 모니터링 (Phase 2.5 추가)
│   │   ├── signal_logger.py
│   │   └── weekly_comparison.py
│   ├── optimization/          # 파라미터 최적화 (Phase 2.5 추가)
│   │   └── grid_search.py
│   ├── nas/                   # NAS 전용 스크립트
│   └── phase2/                # Phase 2 백테스트
│
├── data/
│   ├── cache/                 # Parquet 캐시
│   ├── monitoring/            # 실시간 신호 로그
│   │   ├── signals/
│   │   └── reports/
│   └── optimization/          # 최적화 결과
│
├── docs/
│   ├── MASTER_PLAN_2025.md    # 이 문서
│   ├── CURRENT_STATUS_AND_NEXT_STEPS.md
│   ├── guides/
│   │   ├── HYBRID_EXECUTION_GUIDE.md
│   │   └── nas/
│   └── reports/
│
└── config/
    ├── env.nas.sh             # NAS 환경 변수
    └── env.pc.sh              # PC 환경 변수
```

---

## 📝 주요 문서

### 가이드
- **[하이브리드 실행 가이드](guides/HYBRID_EXECUTION_GUIDE.md)** ⭐ 현재 진행 중
- **[NAS 배포 가이드](guides/nas/deployment.md)**
- **[텔레그램 설정](guides/nas/telegram.md)**
- **[문제 해결](guides/nas/troubleshooting.md)**

### 보고서
- **[Phase 2 완료 요약](reports/phase2/phase2_complete_summary.md)**
- **[Week 3 하이브리드 전략](WEEK3_HYBRID_STRATEGY.md)**
- **[Week 4 자동화 완료](reports/phase2/week4_automation_complete.md)**

### 계획서
- **[Phase 5 Oracle Cloud](plans/phase5_oracle_cloud_plan.md)**
- **[Phase 6 고급 대시보드](plans/phase6_advanced_dashboard_plan.md)**

---

## 🎯 핵심 지표 추적

### 백테스트 성과 (2022-01-01 ~ 2025-11-08)
| 지표 | 현재 | 목표 | 상태 |
|------|------|------|------|
| CAGR | 27.05% | 30% | 🟡 90% |
| Sharpe | 1.51 | 1.5 | ✅ 101% |
| MDD | -19.92% | -12% | 🟡 66% |

### 자동화 시스템 (2025-11-08 ~)
| 항목 | 상태 | 비고 |
|------|------|------|
| 일일 리포트 | ✅ 운영 중 | 평일 16:00 |
| 주간 리포트 | ✅ 운영 중 | 토요일 10:00 |
| 레짐 알림 | ✅ 운영 중 | 실시간 |
| 텔레그램 PUSH | ✅ 정상 | 메시지 개선 완료 |

### 하이브리드 실행 (2025-11-09 ~)
| 항목 | 상태 | 목표일 |
|------|------|--------|
| 도구 구축 | ✅ 완료 | 11/9 |
| 파라미터 최적화 | 🔄 진행 중 | 11/10 |
| 실시간 관찰 | 📋 예정 | 11/11~15 |
| 소액 실전 | 📋 예정 | 11/18~22 |

---

## 💡 핵심 원칙

### 개발 철학
1. **자동화 우선**: 수동 작업 최소화
2. **재현성**: 모든 결과는 로그와 파일로 추적
3. **점진적 개선**: 작은 단위로 테스트 후 확장
4. **리스크 관리**: 손절 엄수, 포지션 제한

### 투자 원칙
1. **데이터 기반 의사결정**: 감정 배제
2. **분산 투자**: 단일 종목 집중 금지
3. **손절 엄수**: -5% 도달 시 무조건 매도
4. **지속적 학습**: 실전 데이터로 전략 개선

### 시간 관리
- **평일**: 10분 (신호 확인)
- **주말**: 2~3시간 (분석 및 개선)
- **월간**: 8~12시간 (파라미터 최적화)

---

## 📞 문제 해결

### 신호가 안 오는 경우
```bash
# NAS Cron 확인
crontab -l

# 로그 확인
tail -f logs/automation/daily_alert_YYYYMMDD.log
```

### 백테스트 오류
```bash
# 데이터 업데이트
python scripts/data/update_ohlcv.py

# 백테스트 재실행
python scripts/phase2/run_backtest_hybrid.py
```

### 성능 저하
- 파라미터 재최적화
- 레짐 감지 민감도 조정
- 리스크 관리 강화

---

## ✅ 체크리스트

### Phase 2 완료 ✅
- [x] Week 1: KRX MAPS 엔진 통합
- [x] Week 2: 방어 시스템 구현
- [x] Week 3: 하이브리드 전략 구현
- [x] Week 4: 자동화 시스템 구현
- [x] NAS PUSH 시스템 구축
- [x] 텔레그램 메시지 개선

### Phase 2.5 진행 중 🔄
- [x] 하이브리드 실행 시스템 구축
- [x] 실시간 신호 기록 도구
- [x] 파라미터 자동 최적화
- [x] 주간 비교 리포트
- [ ] 파라미터 최적화 실행 (50개 조합)
- [ ] 1주일 실시간 관찰
- [ ] 소액 실전 테스트

### Phase 3 예정 📋
- [ ] 장중 실시간 알림
- [ ] 머신러닝 모델 통합
- [ ] 포트폴리오 최적화
- [ ] 백테스트 고도화

---

**작성자**: Cascade AI  
**최종 업데이트**: 2025-11-09  
**다음 마일스톤**: Phase 2.5 완료 (2025-11-22)
