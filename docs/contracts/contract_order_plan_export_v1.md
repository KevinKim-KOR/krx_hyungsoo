# Contract: Order Plan Export V1 (Human-Processable)

## Overview
A minimal, human-readable summary of the Order Plan, designed to be the "Gate" for manual confirmation.
It serves as the bridge between the automated engine and the human operator.

## Schema: `ORDER_PLAN_EXPORT_V1`

### File Path
- **Latest**: `reports/live/order_plan_export/latest/order_plan_export_latest.json`
- **Snapshot**: `reports/live/order_plan_export/snapshots/order_plan_export_{YYYYMMDD_HHMMSS}.json`

### JSON Structure

```json
{
  "schema": "ORDER_PLAN_EXPORT_V1",
  "asof": "2024-01-01T10:00:00.000000",
  "source": {
     "order_plan_ref": "reports/live/order_plan/latest/order_plan_latest.json",
     "plan_id": "plan-20240101-100000-xxxx",
     "decision": "GENERATED"
  },
  "summary": {
     "orders_count": 5,
     "buys_count": 3,
     "sells_count": 2,
     "notes": "Balanced rebalance."
  },
  "orders": [
     {
       "ticker": "005930",
       "side": "BUY",
       "qty": 10,
       "price_ref": 70000,
       "reason": "Rebalance"
     }
  ],
  "human_confirm": {
     "required": true,
     "confirm_token": "46a7226830efd31b" 
     // Note: P140 update -> This token is generated by system for reference,
     // but P140 Prep Logic no longer strictly requires *this specific* string match 
     // if we move to "Record Input" model. 
     // However, for V1 compatibility, we still generate it.
  },
  "decision": "GENERATED"
}
```

### Key Constraints (P140)
1. **Plan ID SSOT**: `source.plan_id` must be present. If Order Plan lacks it, Generator must create one.
2. **Fail-Closed**: If `order_plan` is BLOCKED, Export must be BLOCKED.
3. **Immutability**: Once generated for a plan, it should not change unless Plan changes.
