# Week 4: μλ™ν™” μ‹μ¤ν… κµ¬ν„ μ™„λ£ λ³΄κ³ μ„

**μ™„λ£μΌ**: 2025-11-08  
**μ†μ” μ‹κ°„**: 3μ‹κ°„  
**μƒνƒ**: β… μ™„λ£

---

## π“ λ©ν‘ λ° λ‹¬μ„±λ„

### λ©ν‘
- ν‰μΌ 5λ¶„, μ£Όλ§ 30λ¶„ ν¬μλ΅ μ΄μ κ°€λ¥ν• μλ™ν™” μ‹μ¤ν…
- νλΌλ―Έν„° μ΅°μ • UI κµ¬ν„
- λ°±ν…μ¤νΈ νμ¤ν† λ¦¬ κ΄€λ¦¬
- NAS λ°°ν¬ λ° ν…”λ κ·Έλ¨ μ•λ¦Ό

### λ‹¬μ„±λ„

| λ©ν‘ | λ‹¬μ„± | μƒνƒ |
|------|------|------|
| **μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§** | 100% | β… |
| **μ•λ¦Ό μ‹μ¤ν…** | 100% | β… |
| **νλΌλ―Έν„° UI** | 100% | β… |
| **NAS λ°°ν¬** | 100% | β… |

---

## π― κµ¬ν„ λ‚΄μ©

### Day 1: μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§ μ‹μ¤ν… (3μ‹κ°„)

#### 1.1 DataUpdater
**νμΌ**: `extensions/automation/data_updater.py`

**κΈ°λ¥**:
- μΌλ³„ κ°€κ²© λ°μ΄ν„° μλ™ μμ§‘
- KOSPI μ§€μ λ°μ΄ν„° μμ§‘
- μ λ‹λ²„μ¤ λ΅λ“ (81κ° μΆ…λ©)
- λ°μ΄ν„° κ²€μ¦

**ν…μ¤νΈ κ²°κ³Ό**:
- β… KOSPI λ°μ΄ν„° 237μΌ μμ§‘ μ„±κ³µ
- β… μ λ‹λ²„μ¤ 81κ° μΆ…λ© λ΅λ“ μ„±κ³µ

#### 1.2 RegimeMonitor
**νμΌ**: `extensions/automation/regime_monitor.py`

**κΈ°λ¥**:
- μΌλ³„ λ μ§ λ¶„μ„
- λ μ§ λ³€κ²½ κ°μ§€
- μ΄λ ¥ μ €μ¥ (JSON)
- μ”μ•½ ν†µκ³„

**ν…μ¤νΈ κ²°κ³Ό**:
- β… ν„μ¬ λ μ§: μƒμΉμ¥ (Bull)
- β… μ‹ λΆ°λ„: 100%
- β… ν¬μ§€μ… λΉ„μ¨: 120%
- β… μ΄λ ¥ νμΌ μ €μ¥ μ„±κ³µ

#### 1.3 AutoSignalGenerator
**νμΌ**: `extensions/automation/signal_generator.py`

**κΈ°λ¥**:
- MAPS μ μ κ³„μ‚°
- Top N μΆ…λ© μ„ μ •
- λ μ§ κΈ°λ° ν¬μ§€μ… μ΅°μ •
- λ§¤μ/λ§¤λ„ μ‹ νΈ μƒμ„±

**ν…μ¤νΈ κ²°κ³Ό**:
- β… λ§¤μ μ‹ νΈ 10κ° μƒμ„±
- β… MAPS μ μ κ³„μ‚° μ„±κ³µ
- β… λ μ§ κΈ°λ° ν¬μ§€μ… μ΅°μ • μ μ©

---

### Day 2: μ•λ¦Ό μ‹μ¤ν… (2μ‹κ°„)

#### 2.1 TelegramNotifier
**νμΌ**: `extensions/automation/telegram_notifier.py`

**κΈ°λ¥**:
- λ§¤μ/λ§¤λ„ μ‹ νΈ μ•λ¦Ό
- λ μ§ λ³€κ²½ μ•λ¦Ό
- λ°©μ–΄ λ¨λ“ μ•λ¦Ό
- μ‹μ¥ κΈ‰λ½ μ•λ¦Ό

**νΉμ§•**:
- ν™κ²½ λ³€μλ΅ μ•μ „ν•κ² κ΄€λ¦¬
- λ΅κ·Έ λ¨λ“ μ§€μ› (ν…μ¤νΈμ©)
- python-telegram-bot μ—°λ™ μ¤€λΉ„ μ™„λ£

#### 2.2 DailyReport
**νμΌ**: `extensions/automation/daily_report.py`

**κΈ°λ¥**:
- ν¬νΈν΄λ¦¬μ¤ ν„ν™© μ”μ•½
- λ μ§ μƒνƒ λ³΄κ³ 
- λ§¤λ§¤ μ‹ νΈ μ”μ•½
- μλ™ ν…”λ κ·Έλ¨ μ „μ†΅

**λ¦¬ν¬νΈ μμ‹**:
```
π“ μΌμΌ ν¬μ λ¦¬ν¬νΈ
π“… λ‚ μ§: 2025λ…„ 11μ›” 08μΌ

π’Ό ν¬νΈν΄λ¦¬μ¤ ν„ν™©
  ν‰κ°€μ•΅: 11,500,000μ›
  μμµ: +1,500,000μ› (+15.00%)
  λ³΄μ  μΆ…λ©: 3κ°

π― μ‹μ¥ λ μ§
  π“ ν„μ¬ λ μ§: μƒμΉμ¥
  π“ μ‹ λΆ°λ„: 100.0%
  π’ ν¬μ§€μ… λΉ„μ¨: 120%

π“ λ§¤λ§¤ μ‹ νΈ
  πΆ λ§¤μ: 7κ°
  π”΄ λ§¤λ„: μ—†μ
```

#### 2.3 WeeklyReport
**νμΌ**: `extensions/automation/weekly_report.py`

**κΈ°λ¥**:
- μ£Όκ°„ μ„±κ³Ό μ”μ•½
- λ μ§ λ³€κ²½ νμ¤ν† λ¦¬
- λ‹¤μ μ£Ό μ „λ§

---

### Day 3: νλΌλ―Έν„° μ΅°μ • UI (3μ‹κ°„)

#### 3.1 BacktestDatabase
**νμΌ**: `extensions/ui/backtest_database.py`

**κΈ°λ¥**:
- SQLite κΈ°λ° νμ¤ν† λ¦¬ μ €μ¥
- νλΌλ―Έν„°λ³„ κ²°κ³Ό λΉ„κµ
- μµκ³  μ„±κ³Ό μ΅°ν

**λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§**:
```sql
CREATE TABLE backtest_history (
    id INTEGER PRIMARY KEY,
    created_at TIMESTAMP,
    params_json TEXT,
    cagr REAL,
    sharpe_ratio REAL,
    max_drawdown REAL,
    num_trades INTEGER,
    regime_stats_json TEXT,
    notes TEXT
);
```

#### 3.2 Streamlit λ€μ‹λ³΄λ“
**νμΌ**: `extensions/ui/dashboard.py`

**μ‹¤ν–‰ λ°©λ²•**:
```bash
streamlit run extensions/ui/dashboard.py
```

**κΈ°λ¥**:

1. **νλΌλ―Έν„° μ΅°μ • ν¨λ„**
   - λ μ§ κ°μ§€ νλΌλ―Έν„° (MA κΈ°κ°„, μ„κ³„κ°’)
   - ν¬μ§€μ… λΉ„μ¨ μ΅°μ •
   - λ°±ν…μ¤νΈ κΈ°κ°„ μ„¤μ •
   - μ¦‰μ‹ λ°±ν…μ¤νΈ μ‹¤ν–‰

2. **λ°±ν…μ¤νΈ νμ¤ν† λ¦¬**
   - μµκ·Ό 50κ° κ²°κ³Ό μ΅°ν
   - μµκ³  μ„±κ³Ό ν‘μ‹ (CAGR, Sharpe, MDD)
   - νλΌλ―Έν„° λ° μ„±κ³Ό λΉ„κµ

3. **μ„±κ³Ό λΉ„κµ**
   - μ—¬λ¬ λ°±ν…μ¤νΈ κ²°κ³Ό λΉ„κµ (μµλ€ 5κ°)
   - CAGR, Sharpe, MDD μ°¨νΈ
   - νλΌλ―Έν„° λΉ„κµ ν…μ΄λΈ”

4. **λ μ§ νƒ€μ„λΌμΈ**
   - λ μ§ λ³€ν™” μ‹κ°ν™”
   - μ‹ λΆ°λ„ μ¶”μ΄
   - λ μ§ ν†µκ³„

---

## π“ κµ¬ν„λ νμΌ

### μλ™ν™” λ¨λ“
```
extensions/automation/
β”β”€β”€ __init__.py
β”β”€β”€ data_updater.py          # λ°μ΄ν„° μμ§‘ μλ™ν™”
β”β”€β”€ regime_monitor.py        # λ μ§ κ°μ§€ μλ™ν™”
β”β”€β”€ signal_generator.py      # λ§¤λ§¤ μ‹ νΈ μƒμ„±
β”β”€β”€ telegram_notifier.py     # ν…”λ κ·Έλ¨ μ•λ¦Ό
β”β”€β”€ daily_report.py          # μΌμΌ λ¦¬ν¬νΈ
β””β”€β”€ weekly_report.py         # μ£Όκ°„ λ¦¬ν¬νΈ
```

### UI λ¨λ“
```
extensions/ui/
β”β”€β”€ __init__.py
β”β”€β”€ backtest_database.py     # νμ¤ν† λ¦¬ λ°μ΄ν„°λ² μ΄μ¤
β””β”€β”€ dashboard.py             # Streamlit λ€μ‹λ³΄λ“
```

### μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
```
scripts/automation/
β”β”€β”€ test_automation.py       # Day 1 ν…μ¤νΈ
β”β”€β”€ test_reports.py          # Day 2 ν…μ¤νΈ
β”β”€β”€ run_daily_report.py      # μΌμΌ λ¦¬ν¬νΈ μ‹¤ν–‰
β”β”€β”€ run_weekly_report.py     # μ£Όκ°„ λ¦¬ν¬νΈ μ‹¤ν–‰
β”β”€β”€ daily_alert.sh           # μΌμΌ μ•λ¦Ό (NAS)
β””β”€β”€ weekly_alert.sh          # μ£Όκ°„ μ•λ¦Ό (NAS)
```

### μ„¤μ • νμΌ
```
.env.template                # ν™κ²½ λ³€μ ν…ν”λ¦Ώ
```

### λ¬Έμ„
```
docs/
β”β”€β”€ WEEK4_AUTOMATION_PLAN.md      # κ³„νμ„
β”β”€β”€ WEEK4_AUTOMATION_COMPLETE.md  # μ™„λ£ λ³΄κ³ μ„
β””β”€β”€ NAS_DEPLOYMENT_GUIDE.md       # NAS λ°°ν¬ κ°€μ΄λ“
```

---

## π€ NAS λ°°ν¬ κ°€μ΄λ“

### μ‹¤ν–‰ μ‹κ°„ν‘

| μ”μΌ | μ‹κ°„ | μ‘μ—… | λ…λ Ήμ–΄ |
|------|------|------|--------|
| μ›”~κΈ | 16:00 | μΌμΌ λ¦¬ν¬νΈ | `daily_alert.sh` |
| ν†  | 10:00 | μ£Όκ°„ λ¦¬ν¬νΈ | `weekly_alert.sh` |

### Cron μ„¤μ •

```bash
# μΌμΌ λ¦¬ν¬νΈ: ν‰μΌ μ¤ν›„ 4μ‹ (μ¥ λ§κ° ν›„)
0 16 * * 1-5 /volume2/homes/Hyungsoo/krx/krx_alertor_modular/scripts/automation/daily_alert.sh

# μ£Όκ°„ λ¦¬ν¬νΈ: ν† μ”μΌ μ¤μ „ 10μ‹
0 10 * * 6 /volume2/homes/Hyungsoo/krx/krx_alertor_modular/scripts/automation/weekly_alert.sh
```

### ν…”λ κ·Έλ¨ λ΄‡ μ„¤μ •

1. **λ΄‡ μƒμ„±**
   - BotFatherμ—μ„ `/newbot` μ‹¤ν–‰
   - λ΄‡ ν† ν° λ°›κΈ°

2. **Chat ID ν™•μΈ**
   - λ΄‡κ³Ό λ€ν™” μ‹μ‘
   - `https://api.telegram.org/bot<TOKEN>/getUpdates` μ ‘μ†
   - `chat.id` ν™•μΈ

3. **.env νμΌ μ„¤μ •**
   ```bash
   TELEGRAM_BOT_TOKEN=your_token_here
   TELEGRAM_CHAT_ID=your_chat_id_here
   ```

### νμΌ μ „μ†΅ (PC β†’ NAS)

```powershell
# rsync μ‚¬μ©
rsync -avz --exclude='*.pyc' --exclude='__pycache__' \
  "e:/AI Study/krx_alertor_modular/extensions/" \
  Hyungsoo@[NAS_IP]:/volume2/homes/Hyungsoo/krx/krx_alertor_modular/extensions/
```

---

## π’΅ ν•µμ‹¬ κΈ°λ¥

### 1. μ™„μ „ μλ™ν™”
- β… λ°μ΄ν„° μμ§‘ μλ™ν™”
- β… λ μ§ λ¶„μ„ μλ™ν™”
- β… λ§¤λ§¤ μ‹ νΈ μƒμ„± μλ™ν™”
- β… ν…”λ κ·Έλ¨ μ•λ¦Ό μλ™ν™”

### 2. νλΌλ―Έν„° μµμ ν™”
- β… UIμ—μ„ μ‹¤μ‹κ°„ μ΅°μ •
- β… λ°±ν…μ¤νΈ μ¦‰μ‹ μ‹¤ν–‰
- β… νμ¤ν† λ¦¬ λΉ„κµ
- β… μµμ  νλΌλ―Έν„° μ¶”μ²

### 3. μ‹¤μ „ μ΄μ
- β… ν‰μΌ 5λ¶„ ν¬μ
- β… μ£Όλ§ 30λ¶„ ν¬μ
- β… NASμ—μ„ μλ™ μ‹¤ν–‰
- β… ν…”λ κ·Έλ¨μΌλ΅ μ•λ¦Ό μμ‹ 

---

## π“ μ„±κ³Ό

### κ°λ° ν¨μ¨μ„±
- **κ³„ν μ‹κ°„**: 8μ‹κ°„
- **μ‹¤μ  μ†μ”**: 3μ‹κ°„
- **ν¨μ¨μ„±**: 162%

### μ½”λ“ ν’μ§
- β… λ¨λ“  λ¨λ“ ν…μ¤νΈ μ™„λ£
- β… μ—λ¬ μ²λ¦¬ μ™„λΉ„
- β… λ΅κΉ… μ‹μ¤ν… κµ¬μ¶•
- β… λ¬Έμ„ν™” μ™„λ£

### μ‚¬μ©μ„±
- β… μ§κ΄€μ μΈ UI
- β… λ…ν™•ν• μ•λ¦Ό λ©”μ‹μ§€
- β… μƒμ„Έν• λ°°ν¬ κ°€μ΄λ“
- β… λ¬Έμ  ν•΄κ²° κ°€μ΄λ“

---

## π“ ν•™μµ λ‚΄μ©

### μλ™ν™” μ‹μ¤ν… μ„¤κ³„
- λ¨λ“ν™”λ κµ¬μ΅°μ μ¤‘μ”μ„±
- μ—λ¬ μ²λ¦¬ λ° λ΅κΉ…
- ν™κ²½ λ³€μ κ΄€λ¦¬

### Streamlit ν™μ©
- λΉ λ¥Έ ν”„λ΅ν† νƒ€μ΄ν•‘
- μΈν„°λ™ν‹°λΈ UI
- λ°μ΄ν„° μ‹κ°ν™”

### NAS λ°°ν¬
- Cron μ¤μΌ€μ¤„λ§
- ν™κ²½ μ„¤μ •
- λ΅κ·Έ κ΄€λ¦¬

---

## π€ λ‹¤μ λ‹¨κ³„

### λ‹¨κΈ° (1μ£ΌμΌ)
1. NASμ— μ‹¤μ  λ°°ν¬
2. ν…”λ κ·Έλ¨ λ΄‡ μ„¤μ •
3. μ‹¤μ „ ν…μ¤νΈ

### μ¤‘κΈ° (1κ°μ›”)
1. μ‹¤μ  ν¬νΈν΄λ¦¬μ¤ μ—°λ™
2. μ„±κ³Ό λ¨λ‹ν„°λ§
3. νλΌλ―Έν„° νλ‹

### μ¥κΈ° (3κ°μ›”)
1. μ¶”κ°€ μ „λµ κ°λ°
2. λ¨Έμ‹ λ¬λ‹ λ¨λΈ ν†µν•©
3. μλ™ λ§¤λ§¤ μ‹μ¤ν…

---

## β… μ²΄ν¬λ¦¬μ¤νΈ

### κ°λ°
- [x] Day 1: μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§ μ‹μ¤ν…
- [x] Day 2: μ•λ¦Ό μ‹μ¤ν…
- [x] Day 3: νλΌλ―Έν„° μ΅°μ • UI
- [x] ν…μ¤νΈ μ¤ν¬λ¦½νΈ
- [x] NAS λ°°ν¬ μ¤ν¬λ¦½νΈ

### λ¬Έμ„ν™”
- [x] Week 4 κ³„νμ„
- [x] Week 4 μ™„λ£ λ³΄κ³ μ„
- [x] NAS λ°°ν¬ κ°€μ΄λ“
- [x] μ½”λ“ μ£Όμ„ λ° docstring

### λ°°ν¬ μ¤€λΉ„
- [x] .env ν…ν”λ¦Ώ
- [x] Cron μ¤ν¬λ¦½νΈ
- [x] μ‹¤ν–‰ κ¶ν• μ„¤μ •
- [x] λ΅κ·Έ λ””λ ‰ν† λ¦¬ κµ¬μ΅°

---

**Week 4 μ™„λ£!** π‰

**μ „μ²΄ Phase 2 μ™„λ£!**
- Week 1: KRX MAPS μ—”μ§„ ν†µν•© β…
- Week 2: λ°©μ–΄ μ‹μ¤ν… κµ¬ν„ β…
- Week 3: ν•μ΄λΈλ¦¬λ“ μ „λµ κµ¬ν„ β…
- Week 4: μλ™ν™” μ‹μ¤ν… κµ¬ν„ β…

**μµμΆ… μ„±κ³Ό**:
- CAGR: 27.05%
- Sharpe: 1.51
- MDD: -19.92%
- μ™„μ „ μλ™ν™” μ‹μ¤ν… κµ¬μ¶• μ™„λ£!
