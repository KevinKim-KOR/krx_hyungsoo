# KRX Alertor â€” Future Development Roadmap

> **ìž‘ì„±**: 2025-12-11 (ìµœì¢… ìˆ˜ì •: 2025-12-21)  
> **Author**: í˜•ìˆ˜  
> **ëª©ì **: í–¥í›„ ê°œë°œ í•­ëª© ì˜êµ¬ ê¸°ë¡

---

## ê°œìš”

ì´ ë¬¸ì„œëŠ” í˜„ìž¬ ê°œë°œì´ ì™„ë£Œëœ KRX Alertor ì‹œìŠ¤í…œì˜ **í–¥í›„ ê³ ë„í™” ë¡œë“œë§µ**ì„ ì •ë¦¬í•©ë‹ˆë‹¤.

### Phase ë¶„ë¥˜ë³„ ê°œë°œ í•„ìš”ì„± ìš”ì•½

| Phase | í•­ëª© | ê°œë°œ í•„ìš” ì—¬ë¶€ | ì´ìœ  |
|-------|------|----------------|------|
| **1** | **íŠœë‹/ê²€ì¦ ì²´ê³„** | âœ… **ìµœìš°ì„ ** | Test ë´‰ì¸, ëª©ì í•¨ìˆ˜ ê°œì„ , ë³€ìˆ˜ ìŠ¤í‚¤ë§ˆ í‘œì¤€í™” |
| 2 | ë¯¸ë‹ˆ Walk-Forward | âœ… ê°œë°œ í•„ìš” | ë¡¤ë§ ê²€ì¦ìœ¼ë¡œ ì•ˆì •ì„± í™•ë³´ |
| 3 | ì •ì‹ Walk-Forward | âœ… ê°œë°œ í•„ìš” | ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜/ìœˆë„ìš° ì‹œìŠ¤í…œ |
| 4 | TP/SL ê³ ë„í™” | âœ… ê°œë°œ í•„ìš” | í˜„ìž¬ ë‹¨ì¼ stop_loss ê¸°ë°˜ì´ë¼ êµ¬ì¡° í™•ìž¥ í•„ìš” |
| 5 | Breadth / ì´ë²¤íŠ¸ | âœ… ê°œë°œ í•„ìš” | ì‹ ê·œ ë°ì´í„° + ì‹ ê·œ ë ˆì§ ë¡œì§ |

---

## 1. Phase 1 â€” íŠœë‹/ê²€ì¦ ì²´ê³„ ê°•í™” â­ ìµœìš°ì„ 

> **ìƒì„¸ ì„¤ê³„ ë¬¸ì„œ**: `docs/tuning_validation_design.md`

### 1.1 ë°°ê²½

ìµœê·¼ íŠœë‹ ê²°ê³¼ì—ì„œ **Trainì€ ë†’ê³  Valì€ ë¶€ì§„í•œë° Testê°€ ë¹„ì •ìƒì ìœ¼ë¡œ ë†’ê²Œ íŠ€ëŠ”** íŒ¨í„´ì´ ë°˜ë³µë¨.  
"ë¯¸ì„¸ì¡°ì •ìœ¼ë¡œ ì„±ëŠ¥ ì˜¬ë¦¬ê¸°"ë³´ë‹¤ ë¨¼ì € **ê²€ì¦ ì²´ê³„(Test ë´‰ì¸, ëª©ì í•¨ìˆ˜, ìž¬í˜„ì„±)**ê°€ í•„ìš”.

### 1.2 í•µì‹¬ ê°œë°œ í•­ëª©

#### (1) Test ë´‰ì¸ ì›ì¹™ ì ìš©

| í•­ëª© | í˜„ìž¬ | ê°œì„  |
|------|------|------|
| Optuna objective | Test Sharpe | **Val Sharpe** |
| ê²°ê³¼ í…Œì´ë¸” ì •ë ¬ | Test ê¸°ì¤€ | **Val ê¸°ì¤€** |
| Test ì»¬ëŸ¼ | í•­ìƒ í‘œì‹œ | **ðŸ”’ ì„ íƒ í™•ì • í›„ ê³µê°œ** |

#### (2) ëª©ì í•¨ìˆ˜ ê°œì„ 

```python
# í˜„ìž¬
return test_sharpe

# ê°œì„  (Option A: Val + MDD íŽ˜ë„í‹°)
return val_sharpe - max(0, abs(val_mdd) - 15) * 0.1
```

#### (3) ë³€ìˆ˜ ìŠ¤í‚¤ë§ˆ í‘œì¤€í™”

`config/tuning_variables.yaml` ì‹ ê·œ ìž‘ì„±:
- ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ (trend/momentum/risk/market/execution)
- ë£©ë°±ë³„ ì¶”ì²œ ë²”ìœ„
- ì˜ì¡´ì„±/ì œì•½ ì¡°ê±´
- ì „ëžµì  ì˜ë¯¸/ë¦¬ìŠ¤í¬ ì„¤ëª…

#### (4) UI ê°œì„ 

- ë³€ìˆ˜ ì¹´í…Œê³ ë¦¬ë³„ ì ‘ê¸°/íŽ¼ì¹˜ê¸°
- í™œì„± ë³€ìˆ˜ count + íƒìƒ‰ ê³µê°„ í¬ê¸° í‘œì‹œ
- íŠœë‹ ëª¨ë“œ í”„ë¦¬ì…‹ (Discovery / Stability / Refine)

#### (5) run_manifest ì €ìž¥

ëª¨ë“  íŠœë‹ ì‹¤í–‰ ì¡°ê±´/ê²°ê³¼ë¥¼ JSONìœ¼ë¡œ ì €ìž¥í•˜ì—¬ ìž¬í˜„ì„± ë³´ìž¥.

### 1.3 êµ¬í˜„ ìš°ì„ ìˆœìœ„

| ìˆœì„œ | í•­ëª© | ì˜ˆìƒ ì‹œê°„ |
|------|------|----------|
| 1 | Test ë´‰ì¸ UI ì ìš© | 1ì¼ |
| 2 | Objective í•¨ìˆ˜ ë³€ê²½ (Val ê¸°ë°˜) | 0.5ì¼ |
| 3 | ë³€ìˆ˜ ìŠ¤í‚¤ë§ˆ YAML ìž‘ì„± | 1ì¼ |
| 4 | UI ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ | 1ì¼ |
| 5 | íŠœë‹ ëª¨ë“œ í”„ë¦¬ì…‹ | 0.5ì¼ |
| 6 | run_manifest ì €ìž¥ | 1ì¼ |

---

## 2. Phase 2 â€” ë¯¸ë‹ˆ Walk-Forward

### 2.1 ëª©í‘œ

ì •ì‹ Walk-Forward í”„ë ˆìž„ì›Œí¬ ê°œë°œ ì „, **ìµœì†Œí•œì˜ ë¡¤ë§ ê²€ì¦**ìœ¼ë¡œ ì•ˆì •ì„± í™•ë³´.

### 2.2 ê°œë°œ í•­ëª©

#### (1) ë¡¤ë§ ìœˆë„ìš° ìƒì„±

```
ì „ì²´ ê¸°ê°„: 24ê°œì›”
Window 1: Train 18M | Val 3M | Test 3M
Window 2: Train 18M | Val 3M | Test 3M (stride=2M)
...
```

#### (2) ì•ˆì •ì„± ì ìˆ˜ ê³„ì‚°

```python
stability_score = sharpe_mean / (sharpe_std + 0.1)
```

#### (3) UI í‘œì‹œ

- ìœˆë„ìš°ë³„ ì„±ê³¼ í…Œì´ë¸”
- ì•ˆì •ì„± ì ìˆ˜ ë±ƒì§€
- ìŠ¹ë¥  (Sharpe > 0ì¸ ìœˆë„ìš° ë¹„ìœ¨)

---

## 3. Phase 3 â€” ì •ì‹ Walk-Forward Framework

### 3.1 ëª©í‘œ

- ë‹¨ì¼ ë°±í…ŒìŠ¤íŠ¸ ìƒ˜í”Œì´ ì•„ë‹Œ, **ì—¬ëŸ¬ ì‹œì ì˜ ë¡¤ë§ ìœˆë„ìš°**ì—ì„œì˜ ì„±ëŠ¥ ì•ˆì •ì„± ê²€ì¦
- **íŒŒë¼ë¯¸í„° ë¯¼ê°ë„ì™€ ì•ˆì •ì„± í‰ê°€** (PSS Score)
- ì‹¤ì „ ì ìš© ê°€ëŠ¥ì„± íŒë‹¨ ê¸°ì¤€ ê°•í™”

### 3.2 ê°œë°œ í•„ìš” ìš”ì†Œ

#### (1) ìœˆë„ìš° ìƒì„±ê¸° (Window Generator)

**ê¸°ëŠ¥:**
- ì‹œìž‘ì¼~ì¢…ë£Œì¼ ë²”ìœ„ ë‚´ì—ì„œ ì§€ì •ëœ ê¸°ê°„ ë‹¨ìœ„ë¡œ ìœˆë„ìš° ìƒì„±

**ì˜ˆì‹œ:**
```
lookback = 24M
test = 3M
stride = 1M
â†’ (21M train, 3M test) í˜•íƒœì˜ ë‹¤ì¤‘ ìœˆë„ìš° ìƒì„±
```

**ì¶œë ¥ ì˜ˆ:**
```json
[
  {"train": ("2020-01-01", "2021-09-30"), "test": ("2021-10-01", "2021-12-31")},
  {"train": ("2020-02-01", "2021-10-31"), "test": ("2021-11-01", "2022-01-31")},
  ...
]
```

#### (2) ìœˆë„ìš°ë³„ ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°

- ê¸°ì¡´ `BacktestRunner`ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- ê° ìœˆë„ìš°ì—ì„œ ê°™ì€ ì „ëžµ/íŒŒë¼ë¯¸í„°ë¥¼ ë°˜ë³µ ì‹¤í–‰

**Pseudo:**
```python
for w in windows:
    result = runner.run(window_params)
    collect(results)
```

#### (3) í†µí•© ê²°ê³¼ ê³„ì‚°

ê° ìœˆë„ìš°ë³„ ì§€í‘œë¥¼ ìˆ˜ì§‘í•˜ì—¬ ë‹¤ìŒì„ ê³„ì‚°:
- **í‰ê·  Sharpe**
- **í‰ê·  CAGR**
- **í‰ê·  MDD / ìµœì•… MDD**
- **Sharpe ë¶„ì‚°**
- **ìŠ¹ë¥ ** (Window ìˆ˜ ëŒ€ë¹„ ì„±ê³¼ ìš°ìˆ˜ ë¹„ìœ¨)

#### (4) PSS (Parameter Stability Score)

**ì˜ë¯¸:**
- íŒŒë¼ë¯¸í„°ê°€ ì—¬ëŸ¬ ì‹œì ì—ì„œ ì–¼ë§ˆë‚˜ ì¼ê´€ì ìœ¼ë¡œ ì„±ëŠ¥ì„ ëƒˆëŠ”ì§€ í‰ê°€í•˜ëŠ” ì§€í‘œ

**ê°œë°œ ëŒ€ìƒ:**
- Sharpeì˜ ë³€ë™ì„± (í‘œì¤€íŽ¸ì°¨)
- ìœˆë„ìš°ë³„ Outlier ë¹„ìœ¨
- í‰ê·  ëŒ€ë¹„ ì„±ëŠ¥ ì•ˆì •ì„±

**ê³µì‹ ì˜ˆ:**
```
PSS = Sharpe_mean / (Sharpe_std + epsilon)
```

#### (5) UI & API

- `/api/v1/backtest/walkforward` ì‹ ê·œ
- **ê²°ê³¼ í‘œì‹œ:**
  - Stability Chart
  - Window-by-Window ë¼ì¸ ì°¨íŠ¸
  - PSS ìš”ì•½

---

## 4. Phase 4 â€” TP / SL ê³ ë„í™” (Take Profit / Trailing Stop)

### 4.1 ëª©í‘œ

í˜„ìž¬ ë‹¨ì¼ `stop_loss%` & í•˜ì´ë¸Œë¦¬ë“œ ì†ì ˆ ë§¤íŠ¸ë¦­ìŠ¤ë¥¼ ë„˜ì–´ì„   
**í”„ë¡œíŽ˜ì…”ë„í•œ ë³€ë™ì„± ê¸°ë°˜ ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì‹œìŠ¤í…œ** êµ¬ì¶•

### 4.2 ê°œë°œ ìš”ì†Œ

#### (1) ATR ê¸°ë°˜ Stop Loss

- 14ì¼ ATR ê¸°ë°˜ ë™ì  ì†ì ˆ

**ì˜ˆ:**
```python
stop = entry_price - k * ATR
```

- ë³€ë™ì„± í° ETFëŠ” ë” ë„“ì€ ì†ì ˆ ë²”ìœ„ í™•ë³´

#### (2) Trailing Stop (ê³ ì  ì¶”ì )

**ê¸°ëŠ¥:**
- "ê³ ì  ëŒ€ë¹„ X% í•˜ë½ ì‹œ ë§¤ë„"

**í•„ìš” ìš”ì†Œ:**
- ê³ ì  ê°±ì‹  ë¡œì§
- trailing ê¸°ì¤€ ë™ì  ì—…ë°ì´íŠ¸

#### (3) Take Profit (ìµì ˆ)

**ì „ëžµ ì˜ˆì‹œ:**
- ìˆ˜ìµë¥  +25% ë„ë‹¬ ì‹œ 50% ë¹„ì¤‘ ë§¤ë„
- +40% ë„ë‹¬ ì‹œ ì „ëŸ‰ ë§¤ë„

**ì—”ì§„ ë³€ê²½:**
- `Strategy.evaluate_exit()` ë¡œì§ í™•ìž¥ í•„ìš”

#### (4) íŒŒë¼ë¯¸í„° íŠœë‹ ì—°ë™

Optunaì— ìƒˆë¡œìš´ íŒŒë¼ë¯¸í„° ì¶”ê°€:
- `atr_period`, `atr_k`
- `tp_ratio_1`, `tp_ratio_2`
- `trailing_pct`

---

## 5. Phase 5 â€” Market Breadth & ì´ë²¤íŠ¸ ìº˜ë¦°ë”

### 5.1 ëª©í‘œ

- ì‹œìž¥ì˜ **ì²´ë ¥(ê´‘ë²”ìœ„í•œ ìƒìŠ¹/í•˜ë½ ì°¸ì—¬ë„)**ì„ ë°˜ì˜í•´ ë ˆì§ ì •í™•ë„ ê°•í™”
- **ì´ë²¤íŠ¸ ê¸°ë°˜ íšŒí”¼/ë°©ì–´ í•„í„°** ì¶”ê°€

### 5.2 Breadth ê°œë°œ í•­ëª©

#### (1) ìƒìŠ¹/í•˜ë½ ë¹„ìœ¨
- ì¼ê°„ ìƒìŠ¹ ETF ë¹„ìœ¨
- 20ì¼ í‰ê·  Breadth

#### (2) 52ì£¼ ì‹ ê³ ê°€ / ì‹ ì €ê°€
- ê°•ì„¸ìž¥ í•„í„°ë¡œ í™œìš©

#### (3) AD Line (Advanceâ€“Decline)
- ì¤‘ê¸° ì¶”ì„¸ í•„í„°

#### (4) Breadth Score â†’ ë ˆì§ì— ë°˜ì˜

**ì˜ˆ:**
```python
if breadth_score >= 0.6:
    # Bull ê°•í™”
elif breadth_score <= 0.3:
    # Bear ì£¼ì˜
```

### 5.3 ì´ë²¤íŠ¸ ìº˜ë¦°ë”

**ìˆ˜ì§‘ ëŒ€ìƒ:**
- FOMC
- CPI / PPI
- ê³ ìš©ì§€í‘œ
- ì˜µì…˜ ë§Œê¸°ì¼
- Quadruple Witching Day

**ê¸°ëŠ¥:**
- ì´ë²¤íŠ¸ í•˜ë£¨ ì „ â†’ ë¹„ì¤‘ ì¶•ì†Œ
- ì´ë²¤íŠ¸ ë‹¹ì¼ â†’ ë§¤ìˆ˜ ì¤‘ë‹¨, ì†ì ˆ ê°•í™”

**êµ¬í˜„:**
```python
# EventCalendarService ì‹ ê·œ
if event_today:
    risk_level *= 0.7
```

---

## í˜„ìž¬ ì½”ë“œ êµ¬ì¡°ì™€ì˜ ì—°ê²°

| í˜„ìž¬ ëª¨ë“ˆ | Phase 1 ì—°ê²° | Phase 2-3 ì—°ê²° | Phase 4 ì—°ê²° | Phase 5 ì—°ê²° |
|-----------|--------------|----------------|--------------|---------------|
| `web/dashboard/Strategy.tsx` | Test ë´‰ì¸ UI | - | - | - |
| `app/services/backtest_service.py` | Objective ë³€ê²½ | ìœˆë„ìš°ë³„ ì‹¤í–‰ | - | - |
| `config/tuning_variables.yaml` | ë³€ìˆ˜ ìŠ¤í‚¤ë§ˆ | - | - | - |
| `core/engine/backtest.py` | - | ë¡¤ë§ ë°±í…ŒìŠ¤íŠ¸ | TP/SL ë¡œì§ í™•ìž¥ | - |
| `core/strategy/` | - | - | ìµì ˆ/ì†ì ˆ ì „ëžµ | Breadth í•„í„° |
| `extensions/monitoring/regime.py` | - | - | - | Breadth Score ì—°ë™ |

---

## ìš°ì„ ìˆœìœ„ ì œì•ˆ

1. **Phase 1 (íŠœë‹/ê²€ì¦ ì²´ê³„)** â­ - í˜„ìž¬ íŠœë‹ ê²°ê³¼ì˜ ì‹ ë¢°ë„ í™•ë³´ **ìµœìš°ì„ **
2. **Phase 2 (ë¯¸ë‹ˆ Walk-Forward)** - ìµœì†Œí•œì˜ ë¡¤ë§ ê²€ì¦
3. **Phase 3 (ì •ì‹ Walk-Forward)** - ë³¸ê²©ì ì¸ ì•ˆì •ì„± ê²€ì¦ í”„ë ˆìž„ì›Œí¬
4. **Phase 4 (TP/SL)** - ì‹¤ì „ ìš´ìš© ì‹œ ë¦¬ìŠ¤í¬ ê´€ë¦¬ ê°•í™”
5. **Phase 5 (Breadth/ì´ë²¤íŠ¸)** - ê³ ê¸‰ ê¸°ëŠ¥, ë¦¬ì„œì¹˜ ë³‘í–‰ í•„ìš”

---

## Archive â€” êµ¬í˜„ ì™„ë£Œ í•­ëª©

### âœ… Phase 2.1 â€” ë©€í‹°ë£©ë°± ì¦ê±° ê°•í™” & Real Data Gate0 (2025-12-21)

| í•­ëª© | ìƒíƒœ | ì„¤ëª… |
|------|------|------|
| ë©€í‹°ë£©ë°± debug í•„ë“œ ì¶”ê°€ | âœ… ì™„ë£Œ | `lookback_start_date`, `effective_eval_start`, `bars_used`, `signal_days`, `order_count` |
| manifest by_lookback debug ì €ìž¥ | âœ… ì™„ë£Œ | ë£©ë°±ë³„ë¡œ í™•ì‹¤ížˆ ë‹¤ë¥¸ í•„ë“œ ê¸°ë¡ |
| replay_manifest debug ê²€ì¦ | âœ… ì™„ë£Œ | ë£©ë°±ë³„ `lookback_start_date` ì°¨ì´ í™•ì¸ |
| Gate1 ë¡œê·¸ ë¬¸êµ¬ ì •ë¦¬ | âœ… ì™„ë£Œ | `candidates=N, selected_top_n=M, dedup_removed=K` í˜•ì‹ |
| Real Data Gate0 (Preflight) | âœ… ì™„ë£Œ | `data_digest` í•´ì‹œ, `common_period` ì¶”ê°€ |

**ìµœì¢… ê²€ì¦ ê²°ê³¼ (Mock ëª¨ë“œ)**:
```
[Lookback 3M]  lookback_start=2024-03-30
[Lookback 6M]  lookback_start=2023-12-30
[Lookback 12M] lookback_start=2023-06-30
â†’ ë£©ë°±ë³„ë¡œ í™•ì‹¤ížˆ ë‹¤ë¥¸ ì‹œìž‘ì¼ ê¸°ë¡ë¨ (ë©€í‹°ë£©ë°± ì ìš© ì¦ê±°)
```

### âœ… Phase 2.0 â€” Real Data Gate2 & Force-Gate2 (2025-12-20~21)

| í•­ëª© | ìƒíƒœ |
|------|------|
| `--force-gate2` ì˜µì…˜ êµ¬í˜„ | âœ… ì™„ë£Œ |
| `run_phase20_real_gate2.py` ìŠ¤í¬ë¦½íŠ¸ | âœ… ì™„ë£Œ |
| MiniWalkForward universe_codes ì „ë‹¬ | âœ… ì™„ë£Œ |
| replay_manifest Gate2 WF ê²€ì¦ | âœ… ì™„ë£Œ |

### âœ… íŠœë‹ UI/UX ê¸°ë³¸ ê°œì„  (2025-12-15~16)

| í•­ëª© | ìƒíƒœ |
|------|------|
| íŠœë‹ ì„¤ì • íŒ¨ë„ ì‹ ì„¤ (ê¸°ê°„, ë£©ë°±, Trials) | âœ… ì™„ë£Œ |
| íŠœë‹ ì‹¤í–‰ í™•ì¸ ëª¨ë‹¬ (Confirm ì „ìš©) | âœ… ì™„ë£Œ |
| AI ë¶„ì„ í™œì„±í™” ì¡°ê±´ ê°•í™” (4ê°œ ì¤‘ 2ê°œ ì´ìƒ) | âœ… ì™„ë£Œ |
| ëª¨ë‹¬ ë¬¸êµ¬ ê°œì„  (ë‹¨ì¼ ë°±í…ŒìŠ¤íŠ¸ vs ë²”ìœ„ íƒìƒ‰ ëª…í™•í™”) | âœ… ì™„ë£Œ |
| AI ë¶„ì„ í”„ë¡¬í”„íŠ¸ì— ë°±í…ŒìŠ¤íŠ¸ ê¸°ê°„ ì¶”ê°€ | âœ… ì™„ë£Œ |
